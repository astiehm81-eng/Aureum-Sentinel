name: Aureum Sentinel V42 Broad-Scan

on:
  schedule:
    - cron: '*/20 * * * *' # Startet alle 20 Minuten
  workflow_dispatch:      # Manueller Start möglich

jobs:
  run-sentinel:
    runs-on: ubuntu-latest
    permissions:
      contents: write

    steps:
      - name: Checkout Repository
        uses: actions/checkout@v4

      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.10'

      - name: Install Dependencies
        run: pip install requests beautifulsoup4

      - name: Run Sentinel Broad-Scan
        run: |
          # Führt das Skript aus (15 Min Sammelzeit)
          python sentinel_final.py

      - name: Clean and Commit Data
        run: |
          git config --local user.email "sentinel-bot@github.com"
          git config --local user.name "Aureum-Sentinel-Bot"
          
          # Sicherstellen, dass die CSV existiert
          if [ -f sentinel_market_data.csv ]; then
            git add sentinel_market_data.csv
            # Committet die neuen Daten inkl. Spreads und News
            git commit -m "Sentinel V42: 15min Broad-Scan & 48h-Cleanup [skip ci]" || echo "Keine Änderungen"
            git push
          fi
